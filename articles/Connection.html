<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Connection • SAILR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Connection">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SAILR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Connection.html">Connection</a></li>
    <li><a class="dropdown-item" href="../articles/DatasetContainer.html">DatasetContainer</a></li>
    <li><a class="dropdown-item" href="../articles/Profile.html">Profile</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Connection</h1>
                        <h4 data-toc-skip class="author">Jack
Scanlon</h4>
            
            <h4 data-toc-skip class="date">2024-09-08</h4>
      

      <div class="d-none name"><code>Connection.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="the-sailrconnection-class">The <code>SAILR::Connection</code> class<a class="anchor" aria-label="anchor" href="#the-sailrconnection-class"></a>
</h2>
<p>This <code>R6</code> class is intended to be used as a database
interface (<em>DBI</em>), allowing you to write code that interacts with
the SAIL Databank database.</p>
<blockquote>
<p><em><strong>IMPORTANT:</strong> Please note, you can see the
differences between <code>SAILR</code> and <code>SAILDBUtils</code> in
the <a href="#Comparison-of-SAILR-and-SAILDBUtils">Comparison of SAILR
and SAILDBUtils</a> section</em></p>
</blockquote>
<div class="section level3">
<h3 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h3>
<div class="section level4">
<h4 id="how-to-connect-via-your-gateway-account">How to connect via your Gateway account<a class="anchor" aria-label="anchor" href="#how-to-connect-via-your-gateway-account"></a>
</h4>
<blockquote>
<p><em><strong>Note:</strong> Don’t forget to load the package into your
enviroment by entering the following:
<code><a href="https://rdrr.io/r/base/library.html" class="external-link">library(SAILR)</a></code></em></p>
</blockquote>
<p>Since most users of the SAIL databank will connect using the same
account credentials as their gateway account, you can simply initialise
a new <code><a href="../reference/SAIL-Connection.html">SAILR::Connection</a></code> instance.</p>
<p>This method will utilise the <a href="./Profile.html">SAILR::Profile</a> class to automatically collect
your machine’s <code>username</code>. This class helps you keep your
password safe by storing it on your local machine in an encrypted state
and helps to ensure that you don’t accidentally leak it within your
source code and/or your <code>.RData</code> files. It will also help you
save a little time as you won’t have to reenter your password on the
next attempt if you choose to save your secret.</p>
<p>Calling this method for the first time will open a window prompting
you to enter your password; and once complete, you will be connected to
the database. If successful, you will be asked if you want to save your
password as a secret on your device. However, do note that you will be
prompted to renter it if you ever change your account’s password!</p>
<p>To use this method, simply enter the following:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Automatically connect to the `PR_SAIL` database using your current username</span></span>
<span><span class="va">db</span> <span class="op">=</span> <span class="va"><a href="../reference/SAIL-Connection.html">Connection</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check if we're connected</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">connected</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">'I am connected!'</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Please do note that you only have to do this a single time in your R
environment assuming you store it as a global variable, <em>e.g.</em>
outside of some function / local scope; the examples throughout this
document include a line in which a connection is made - you can safely
ignore this line if you have already connected to the database!</p>
</div>
<div class="section level4">
<h4 id="how-to-connect-using-another-methoddatabaseusername">How to connect using another method/database/username<a class="anchor" aria-label="anchor" href="#how-to-connect-using-another-methoddatabaseusername"></a>
</h4>
<blockquote>
<p><em><strong>Note:</strong> You don’t have to supply your password as
in the following example if you don’t want to, you will be prompted to
enter it via a window if you leave it unspecified - this is actually the
preferred option as not to accidentally leak your password!</em></p>
</blockquote>
<p>If you use an account that’s different from your gateway username,
need to connect to a database other than <code>PR_SAIL</code> or
otherwise then you can modify the connection behaviour by specifying the
following arguments.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">=</span> <span class="va"><a href="../reference/SAIL-Connection.html">Connection</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="co"># The database username</span></span>
<span>  username <span class="op">=</span> <span class="st">'some_username'</span>,</span>
<span>  <span class="co"># The password associated with the username</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="co">#  NOTE:</span></span>
<span>  <span class="co">#    Adding your password directly into the code is highly discouraged,</span></span>
<span>  <span class="co">#    consider using the example above if you can, or just don't supply</span></span>
<span>  <span class="co">#    your password and SAILR:Connection will ask you for it!!</span></span>
<span>  <span class="co">#</span></span>
<span>  password <span class="op">=</span> <span class="st">'some_password'</span>,</span>
<span>  <span class="co"># The database name</span></span>
<span>  database <span class="op">=</span> <span class="st">'PR_NHSD'</span> <span class="co"># ...or some other database!</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>If you’d rather not use the <a href="./Profile.html">SAILR::Profile</a> class to store and/or manage
your secrets, you can amend the <code>use.profile</code> option:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">=</span> <span class="va"><a href="../reference/SAIL-Connection.html">Connection</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="co"># The database username</span></span>
<span>  username    <span class="op">=</span> <span class="st">'some_username'</span>,</span>
<span>  <span class="co"># The password associated with the username</span></span>
<span>  password    <span class="op">=</span> <span class="st">'some_password'</span>,</span>
<span>  <span class="co"># The database name</span></span>
<span>  database    <span class="op">=</span> <span class="st">'PR_SAIL'</span>,</span>
<span>  <span class="co"># Turn off the Profile secret manager</span></span>
<span>  use.profile <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="how-to-remove-your-saved-secretspasswords">How to remove your saved secrets/passwords<a class="anchor" aria-label="anchor" href="#how-to-remove-your-saved-secretspasswords"></a>
</h4>
<p>See the <a href="./Profile.html">SAILR::Profile</a> for information
on how to interact with and manage your secrets; but if your intention
is to interact with the <code>Profile</code> class through your
<code><a href="../reference/SAIL-Connection.html">SAILR::Connection</a></code> instance, you can call the
<code>Connection$get.profile()</code> method:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">=</span> <span class="va"><a href="../reference/SAIL-Connection.html">Connection</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span> <span class="co"># if you haven't already connected</span></span>
<span></span>
<span><span class="co"># Get the profile instance</span></span>
<span><span class="va">my.profile</span> <span class="op">=</span> <span class="va">db</span><span class="op">$</span><span class="fu">get.profile</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Delete the secrets associated with a username</span></span>
<span><span class="va">my.profile</span><span class="op">$</span><span class="fu">remove.secrets</span><span class="op">(</span><span class="st">'username_to_remove'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Or, if you want to delete the secrets related to the current connection...</span></span>
<span><span class="va">my.profile</span><span class="op">$</span><span class="fu">remove.secrets</span><span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="va">username</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="options-to-modify-behaviour">Options to modify behaviour<a class="anchor" aria-label="anchor" href="#options-to-modify-behaviour"></a>
</h4>
<p>There are several options available that can be modified at a global
level so that you don’t have to continuously pass them to the method
repeatedly, these include:</p>
<ul>
<li>
<code>SAILR.USE.SECRETS</code>: Whether to use the SAILR::Profile
manager to store &amp; load secrets, i.e. a password storage manager for
each username used to authenticate database connections</li>
<li>
<code>SAILR.DROP.UDF</code>: Specifies whether the
<code>SAILR::Connection$drop()</code> method should use the SAIL
user-defined function instead of using an anonymous procedure</li>
<li>
<code>SAILR.CHUNK.SIZE</code>: Describes the number of rows to be
sent in each statement when saving a <code>data.frame</code> to the
database; this can be reduced or increased depending on how wide your
table structure is</li>
<li>
<code>SAILR.TIMEZONE</code>: Specifies the timezone used for
<code>DATE</code>, <code>TIMESTAMP</code> and <code>DATE</code>
columns</li>
<li>
<code>SAILR.QUIET</code>: Determines whether the
<code><a href="../reference/SAIL-Connection.html">SAILR::Connection</a></code> methods will send condition messages when
operations are started / finished; can be used to measure performance
and/or debug statement(s)</li>
<li>
<code>SAILR.NO.WARN</code>: Determines whether warnings will be
logged to the console</li>
<li>
<code>SAILR.THROW.ERRORS</code>: Specifies whether the current
thread should be halted when an error is encountered; you are expected
to wrap your <code><a href="../reference/SAIL-Connection.html">SAILR::Connection</a></code> calls with an error handler
if you deactivate this option</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="interacting-with-the-database">Interacting with the database<a class="anchor" aria-label="anchor" href="#interacting-with-the-database"></a>
</h3>
<div class="section level4">
<h4 id="submitting-statements">Submitting statements<a class="anchor" aria-label="anchor" href="#submitting-statements"></a>
</h4>
<p>Several methods are available to submit a statement to the
database:</p>
<ol style="list-style-type: decimal">
<li>The <code>$run</code> method
<ul>
<li>This is a generic method to submit any type of statement to the
database, whether that be a query or a statement to be executed, and is
similar to the <code>SAILDBUtils::runSQL</code> method</li>
<li>As such, the return value for the <code>$run</code> method can vary
depending on the query ran, see the example below for details:</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">=</span> <span class="va"><a href="../reference/SAIL-Connection.html">Connection</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span> <span class="co"># if you haven't already connected</span></span>
<span></span>
<span><span class="co"># Sends a query to the database which will return a `data.frame()` object</span></span>
<span><span class="co"># like below...</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#  |   | IBMREQD |</span></span>
<span><span class="co">#  |---|---------|</span></span>
<span><span class="co">#  | 1 | Y       |</span></span>
<span><span class="co"># </span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  SELECT *</span></span>
<span><span class="st">    FROM SYSIBM.SYSDUMMY1;</span></span>
<span><span class="st">"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Submits a statement to the database and executes it, will return a logical</span></span>
<span><span class="co"># value (TRUE/FALSE) and may include an attribute that describes how many rows were affected</span></span>
<span><span class="co">#</span></span>
<span><span class="va">success</span> <span class="op">=</span> <span class="va">db</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  DECLARE GLOBAL TEMPORARY TABLE SESSION.SOME_TABLE (</span></span>
<span><span class="st">    SOME_BIG_NUMBER       BIGINT,</span></span>
<span><span class="st">    sOME_SMALLER_NUMBER   INTEGER,</span></span>
<span><span class="st">    SOME_TEXT             VARCHAR(10)</span></span>
<span><span class="st">  )</span></span>
<span><span class="st">    WITH REPLACE;</span></span>
<span><span class="st">"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">success</span>, <span class="st">'rows.affected'</span><span class="op">)</span><span class="op">)</span> <span class="co"># will print 0</span></span></code></pre></div>
</li>
<li>The <code>$query</code> method
<ul>
<li>This method is solely to submit queries, <em>e.g.</em> some
<code>SELECT</code> statement, to the database; this method is preferred
when executing a transaction - talked about in the <a href="#Executing-transactions">Executing transactions</a> section
below</li>
<li>This method can be used in the same way above but will throw an
error if the return value isn’t a data frame, <em>e.g.</em>:</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">=</span> <span class="va"><a href="../reference/SAIL-Connection.html">Connection</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span> <span class="co"># if you haven't already connected</span></span>
<span></span>
<span><span class="co"># Sends a query to the database which will return a `data.frame()` object</span></span>
<span><span class="co"># like below...</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#  |   | IBMREQD |</span></span>
<span><span class="co">#  |---|---------|</span></span>
<span><span class="co">#  | 1 | Y       |</span></span>
<span><span class="co"># </span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">query</span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  SELECT *</span></span>
<span><span class="st">    FROM SYSIBM.SYSDUMMY1;</span></span>
<span><span class="st">"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Attempting to submit a non-query statement that doesn't return a</span></span>
<span><span class="co"># `data.frame()` object will throw an error:</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">query</span><span class="op">(</span><span class="st">"INSERT INTO SYSIBM.SYSDUMMY1 (IBMREQD) VALUES ('N'), ('Y');"</span><span class="op">)</span> <span class="co"># Oops, error!</span></span></code></pre></div>
</li>
<li>The <code>$execute</code> method
<ul>
<li>This method is solely to submit &amp; execute statements that
perform data manipulation (<em>e.g.</em>, <code>UPDATE</code>,
<code>INSERT</code>, <code>DELETE</code>, <code>DROP</code>
<em>etc</em>); and as above, is the preferred method when executing
transactions</li>
<li>Despite the, this method can be used in the same way as described in
the previous example, <em>e.g.</em>:</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">=</span> <span class="va"><a href="../reference/SAIL-Connection.html">Connection</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span> <span class="co"># if you haven't already connected</span></span>
<span></span>
<span><span class="co"># Submit and syncrhonously execute some data manipulation statement...</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#  NOTE:</span></span>
<span><span class="co">#   - Unlike the previous example, this will return an integer value</span></span>
<span><span class="co">#     instead of a logical (TRUE/FALSE);</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#   - Instead, this method will directly return the number of rows</span></span>
<span><span class="co">#     that have been affected'</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#   - In the case of the statement executed below, this will be an integer</span></span>
<span><span class="co">#     value of `0`</span></span>
<span><span class="co">#</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">execute</span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  DECLARE GLOBAL TEMPORARY TABLE SESSION.SOME_TABLE (</span></span>
<span><span class="st">    SOME_BIG_NUMBER       BIGINT,</span></span>
<span><span class="st">    sOME_SMALLER_NUMBER   INTEGER,</span></span>
<span><span class="st">    SOME_TEXT             VARCHAR(10)</span></span>
<span><span class="st">  )</span></span>
<span><span class="st">    WITH REPLACE;</span></span>
<span><span class="st">"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># As in the case of the `db$query` method, attempting to submit</span></span>
<span><span class="co"># a query to the `db$execute` method will throw an error:</span></span>
<span><span class="co">#</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">execute</span><span class="op">(</span><span class="st">"SELECT * FROM SYSIBM.SYSDUMMY1;"</span><span class="op">)</span> <span class="co"># Oops, error!</span></span></code></pre></div>
</li>
</ol>
</div>
<div class="section level4">
<h4 id="executing-transactions">Executing transactions<a class="anchor" aria-label="anchor" href="#executing-transactions"></a>
</h4>
<p>If you need to run sequential, synchronous SQL statements and/or
queries you can create and run a transaction using the
<code>Connection$transaction</code> method.</p>
<p>The expression specified when calling this method is automatically
committed at the end of the statement unless either (a) an error occurs
or (b) you manually call the <code>Connection$exit.transaction</code>
method.</p>
<p>Rollbacks are automatically performed when the transaction is exited,
either through an error or through calling the aforementioned
<code>$exit.transaction</code> method.</p>
<p>Please see the following example on how to create &amp; execute your
own transaction:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">=</span> <span class="va"><a href="../reference/SAIL-Connection.html">Connection</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span> <span class="co"># if you haven't already connected</span></span>
<span></span>
<span><span class="va">success</span> <span class="op">=</span> <span class="va">db</span><span class="op">$</span><span class="fu">transaction</span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="co"># Create some session table</span></span>
<span>  <span class="va">db</span><span class="op">$</span><span class="fu">execute</span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">    DECLARE GLOBAL TEMPORARY TABLE SESSION.SOME_TABLE (</span></span>
<span><span class="st">      SOME_BIG_NUMBER       BIGINT,</span></span>
<span><span class="st">      sOME_SMALLER_NUMBER   INTEGER,</span></span>
<span><span class="st">      SOME_TEXT             VARCHAR(10)</span></span>
<span><span class="st">    )</span></span>
<span><span class="st">      WITH REPLACE;</span></span>
<span><span class="st">  "</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Insert some data</span></span>
<span>  <span class="va">db</span><span class="op">$</span><span class="fu">execute</span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">    INSERT INTO SESSION.SOME_TABLE (SOME_BIG_NUMBER, SOME_SMALLER_NUMBER, SOME_TEXT)</span></span>
<span><span class="st">    VALUES</span></span>
<span><span class="st">      (1, 2, 'HELLO'),</span></span>
<span><span class="st">      (3, 4, 'WORLD!');</span></span>
<span><span class="st">  "</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Get our current table</span></span>
<span>  <span class="va">my.values</span> <span class="op">=</span> <span class="va">db</span><span class="op">$</span><span class="fu">query</span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">    SELECT *</span></span>
<span><span class="st">      FROM SESSION.SOME_TABLE;</span></span>
<span><span class="st">  "</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Some example condition to determine whether we should rollback our</span></span>
<span>  <span class="co"># transaction</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">my.values</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">db</span><span class="op">$</span><span class="fu">exit.transaction</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Unless an error occurred, or if the `db$exit.transaction()` call happened (which it shouldn't have!)</span></span>
<span><span class="co"># then we can continue on with our other tasks, e.g. ...</span></span>
<span><span class="co">#</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">success</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Our `my.values` variable from earlier is accessible outside the `db$transaction` statement</span></span>
<span>  <span class="co"># as it shares the same environment</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="co"># This will print:</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="co">#  |   | SOME_BIG_NUMBER | SOME_SMALLER_NUMBER | SOME_TEXT |</span></span>
<span>  <span class="co">#  |---|-----------------|---------------------|-----------|</span></span>
<span>  <span class="co">#  | 1 | 1               | 2                   | 'HELLO'   |</span></span>
<span>  <span class="co">#  | 2 | 3               | 4                   | 'WORLD!'  |</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">my.values</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="creating-tables-in-sql-from-r">Creating tables in SQL from R<a class="anchor" aria-label="anchor" href="#creating-tables-in-sql-from-r"></a>
</h3>
<div class="section level4">
<h4 id="sql-tables-from-r-data-frame-objects">SQL tables from R <code>data.frame()</code> objects<a class="anchor" aria-label="anchor" href="#sql-tables-from-r-data-frame-objects"></a>
</h4>
<p>You can create a table from a <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame()</a></code> object using
the <code>Connection$save()</code> method. This method attempts to save
a <code>data.frame</code> object to an SQL table; either by creating a
new table or appending the data to an existing table, dependent on the
arguments you specify. Please do note that this operation is
transactional so will be rolled back if it fails at any point.</p>
<p>An example of how to do this can be seen below:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">=</span> <span class="va"><a href="../reference/SAIL-Connection.html">Connection</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span> <span class="co"># if you haven't already connected</span></span>
<span></span>
<span><span class="co"># Some data that we want to create an SQL from:</span></span>
<span><span class="va">some.data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  some_number <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  some_text   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'hello'</span>, <span class="st">'world!'</span><span class="op">)</span>,</span>
<span>  some_date   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">'2024-09-07'</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">'2024-09-07'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  some_time   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">as.ITime</span><span class="op">(</span><span class="st">'10:00'</span><span class="op">)</span>, <span class="fu">as.ITime</span><span class="op">(</span><span class="st">'10:00'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  some_double <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.1</span>, <span class="fl">1.2</span><span class="op">)</span>,</span>
<span>  some_bool   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save our data to a new table:</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">save</span><span class="op">(</span></span>
<span>  <span class="co"># The name of the table (in our example we're using a temporary `SESSION`</span></span>
<span>  <span class="co"># table)</span></span>
<span>  <span class="st">'SESSION.SOME_EXAMPLE_TABLE'</span>,</span>
<span>  <span class="co"># The data</span></span>
<span>  <span class="va">some.data</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Let's pretend we realised we made a mistake and want to overwrite our table</span></span>
<span><span class="co"># with new data:</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">save</span><span class="op">(</span></span>
<span>  <span class="co"># The name of the table (in our example we're using a temporary `SESSION`</span></span>
<span>  <span class="co"># table)</span></span>
<span>  <span class="st">'SESSION.SOME_EXAMPLE_TABLE'</span>,</span>
<span>  <span class="co"># The data</span></span>
<span>  <span class="va">some.data</span>,</span>
<span>  <span class="co"># Let our `$save()` method call overwrite the old table</span></span>
<span>  can.overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Maybe we want to append the data to the table instead of creating a new one:</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">save</span><span class="op">(</span></span>
<span>  <span class="co"># The name of the table (in our example we're using a temporary `SESSION`</span></span>
<span>  <span class="co"># table)</span></span>
<span>  <span class="st">'SESSION.SOME_EXAMPLE_TABLE'</span>,</span>
<span>  <span class="co"># The data (let's pretend this is a different set of data!)</span></span>
<span>  <span class="va">some.data</span>,</span>
<span>  <span class="co"># Let our `$save()` method call overwrite the old table</span></span>
<span>  can.append <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Additional options that you might want to use:</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">save</span><span class="op">(</span></span>
<span>  <span class="co"># The name of the table (in our example we're using a temporary `SESSION`</span></span>
<span>  <span class="co"># table)</span></span>
<span>  table.reference    <span class="op">=</span> <span class="st">'SESSION.SOME_EXAMPLE_TABLE'</span>,</span>
<span>  <span class="co"># The data</span></span>
<span>  table.data         <span class="op">=</span> <span class="va">some.data</span>,</span>
<span>  <span class="co"># Whether to append to the table if it already exists; default is `FALSE`</span></span>
<span>  can.append         <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="co"># Whether to truncate and overwrite the table if it already exists; default</span></span>
<span>  <span class="co"># is `FALSE</span></span>
<span>  can.overwrite      <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="co"># Whether to strip all non-DB2 compliant characters from a column's name; the </span></span>
<span>  <span class="co"># default is `TRUE`</span></span>
<span>  sanitise.columns   <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="co"># Whether to insert logical types as a number of either `1` or `0`, or to</span></span>
<span>  <span class="co"># save it as a `TRUE` / `FALSE` character - the default to this is `TRUE`</span></span>
<span>  logical.as.integer <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="co"># Whether to attempt to parse character columns as one of the following</span></span>
<span>  <span class="co"># `[ DATE | TIME | TIMESTAMP ]`; the default here is `FALSE`</span></span>
<span>  parse.datetimes    <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="co"># Whether we should alters tables to stop logging initially to speed up</span></span>
<span>  <span class="co"># insert(s); the default here is `TRUE`</span></span>
<span>  reduce.db.logging  <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="co"># Determines the size of insert statement chunks; defaults to `1000`</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="co">#  NOTE:</span></span>
<span>  <span class="co">#   - We chunk the insert statements to speed things up, you might want to</span></span>
<span>  <span class="co">#     play around with this number if you have a lot of columns</span></span>
<span>  <span class="co">#</span></span>
<span>  chunk.size         <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="safely-creating-sql-tables-from-select-statements">Safely creating SQL tables from <code>SELECT</code> statements<a class="anchor" aria-label="anchor" href="#safely-creating-sql-tables-from-select-statements"></a>
</h4>
<p>This is a safe wrapper to create a new table from a
<code>SELECT</code> statement that uses transactions; it offers extended
behaviour to make this operation slightly easier:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">=</span> <span class="va"><a href="../reference/SAIL-Connection.html">Connection</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span> <span class="co"># if you haven't already connected</span></span>
<span></span>
<span><span class="co"># Create a table from select statement / another table:</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">create.from</span><span class="op">(</span></span>
<span>  <span class="co"># The new table name</span></span>
<span>  <span class="st">'SESSION.OTHER_EXAMPLE_TABLE'</span>,</span>
<span>  <span class="co"># The select statement</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="co">#  NOTE:</span></span>
<span>  <span class="co">#    Don't include an SQL delimiter at the end of your</span></span>
<span>  <span class="co">#    statement here, i.e. don't add a semi-colon (`;`)!</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="st">"</span></span>
<span><span class="st">    SELECT</span></span>
<span><span class="st">        'Hello, world!' as SOME_TEXT</span></span>
<span><span class="st">      FROM SYSIBM.SYSDUMMY1</span></span>
<span><span class="st">  "</span>,</span>
<span>  <span class="co"># Whether to append this SQL statement to the table</span></span>
<span>  <span class="co"># if already exists; defaults to `FALSE`</span></span>
<span>  can.append <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="co"># Whether to drop any existing `SESSION.OTHER_EXAMPLE_TABLE`</span></span>
<span>  <span class="co"># if it already exists; defaults to `FALSE`</span></span>
<span>  can.overwrite <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="remapping-sql-tables-with-names-specified-in-r">Remapping SQL tables with names specified in R<a class="anchor" aria-label="anchor" href="#remapping-sql-tables-with-names-specified-in-r"></a>
</h4>
<p>Another helpful, safe wrapper to help you create a new table from
another table whilst mapping its column names to a different subset of
column names specified through R. An example of this can be seen
below:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">=</span> <span class="va"><a href="../reference/SAIL-Connection.html">Connection</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span> <span class="co"># if you haven't already connected</span></span>
<span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">map.from</span><span class="op">(</span></span>
<span>  <span class="co"># Our old table to copy the data from - we're using the table</span></span>
<span>  <span class="co"># from the example above here!</span></span>
<span>  input.reference   <span class="op">=</span> <span class="st">'SESSION.OTHER_EXAMPLE_TABLE'</span>,</span>
<span>  <span class="co"># Our new table that we want to map into</span></span>
<span>  output.reference  <span class="op">=</span> <span class="st">'SESSION.SHINY_NEW_TABLE'</span>,</span>
<span>  <span class="co"># A list of column names that we want to map to and from;</span></span>
<span>  <span class="co"># in which the key (left-hand side) is the old column name,</span></span>
<span>  <span class="co"># and the value (right-hand side) is the new column name</span></span>
<span>  output.map        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    SOME_TEXT <span class="op">=</span> <span class="st">'NEW_COLUMN_NAME'</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="co"># Whether to overwrite the 'SESSION.SHINY_NEW_TABLE'</span></span>
<span>  <span class="co"># if it already exists; defaults to `FALSE`</span></span>
<span>  can.overwrite     <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="co"># Whether to reduce db logging by turning off the initial</span></span>
<span>  <span class="co"># logs; defaults to `TRUE`</span></span>
<span>  reduce.db.logging <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="helpful-methods">Helpful methods<a class="anchor" aria-label="anchor" href="#helpful-methods"></a>
</h3>
<div class="section level4">
<h4 id="granting-others-access-to-a-table-or-a-schema">Granting others access to a table or a schema<a class="anchor" aria-label="anchor" href="#granting-others-access-to-a-table-or-a-schema"></a>
</h4>
<p>When working with another colleague or team member you will often
have to grant them access to the tables you have created, the
<code><a href="../reference/SAIL-Connection.html">SAILR::Connection</a></code> class has a method which can help you
safely perform this operation on one or more tables for one or more
users:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">=</span> <span class="va"><a href="../reference/SAIL-Connection.html">Connection</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span> <span class="co"># if you haven't already connected</span></span>
<span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">grant</span><span class="op">(</span></span>
<span>  <span class="co"># The schema in which the table(s) exist</span></span>
<span>  schema <span class="op">=</span> <span class="st">'SAILW9999V'</span>,</span>
<span>  <span class="co"># The tables you want to grant access to</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="co">#  NOTE:</span></span>
<span>  <span class="co">#    - If this is left as `NA` (undefined) then the</span></span>
<span>  <span class="co">#      users that are selected will be granted access</span></span>
<span>  <span class="co">#      to all of the tables in the schema!</span></span>
<span>  <span class="co">#    - Note that the `tables` argument Can be one or more tables, or left</span></span>
<span>  <span class="co">#      blank to grant access to all tables!</span></span>
<span>  <span class="co">#</span></span>
<span>  tables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'SOME_EXAMPLE_TABLE'</span>, <span class="st">'OTHER_EXAMPLE_TABLE'</span>, <span class="st">'SHINY_NEW_TABLE'</span><span class="op">)</span>,</span>
<span>  <span class="co"># The users who should be granted access to the tables above</span></span>
<span>  users <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'some.colleague'</span>, <span class="st">'other.colleague'</span><span class="op">)</span> <span class="co"># Can be one or more users!</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="checking-if-a-table-name-is-a-temporary-table">Checking if a table name is a temporary table<a class="anchor" aria-label="anchor" href="#checking-if-a-table-name-is-a-temporary-table"></a>
</h4>
<p>The following method can be used to determine whether a table name
refers to a temporary table:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">=</span> <span class="va"><a href="../reference/SAIL-Connection.html">Connection</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span> <span class="co"># if you haven't already connected</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">db</span><span class="op">$</span><span class="fu">is.temporary</span><span class="op">(</span><span class="st">'SESSION.SOME_OTHER_TABLE'</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">'it is temporary!'</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="checking-if-an-sql-table-exists">Checking if an SQL table exists<a class="anchor" aria-label="anchor" href="#checking-if-an-sql-table-exists"></a>
</h4>
<p>The following can be used to determine whether a table exists without
throwing an error:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">=</span> <span class="va"><a href="../reference/SAIL-Connection.html">Connection</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span> <span class="co"># if you haven't already connected</span></span>
<span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">exists</span><span class="op">(</span><span class="st">'SESSION.OTHER_EXAMPLE_TABLE'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="dropping-an-sql-table">Dropping an SQL table<a class="anchor" aria-label="anchor" href="#dropping-an-sql-table"></a>
</h4>
<p>The following method can be used to safely drop an SQL table without
throwing an error:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">=</span> <span class="va"><a href="../reference/SAIL-Connection.html">Connection</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span> <span class="co"># if you haven't already connected</span></span>
<span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">drop</span><span class="op">(</span><span class="st">'SESSION.SOME_EXAMPLE_TABLE'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="truncating-an-sql-table">Truncating an SQL table<a class="anchor" aria-label="anchor" href="#truncating-an-sql-table"></a>
</h4>
<p>The following method can be used to truncate an SQL table:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">=</span> <span class="va"><a href="../reference/SAIL-Connection.html">Connection</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span> <span class="co"># if you haven't already connected</span></span>
<span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">truncate</span><span class="op">(</span><span class="st">'SESSION.OTHER_EXAMPLE_TABLE'</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="misc--methods">Misc. methods<a class="anchor" aria-label="anchor" href="#misc--methods"></a>
</h3>
<div class="section level4">
<h4 id="static-methods">Static methods<a class="anchor" aria-label="anchor" href="#static-methods"></a>
</h4>
<p>The following static methods may be used for type validation &amp;
validating <code><a href="../reference/SAIL-Connection.html">SAILR::Connection</a></code> instances:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">=</span> <span class="va"><a href="../reference/SAIL-Connection.html">Connection</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span> <span class="co"># if you haven't already connected</span></span>
<span></span>
<span><span class="co"># Check if some object is a `SAILR::Connection`</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#  NOTE:</span></span>
<span><span class="co">#   - Static methods CANNOT be accessed via the `db` instance;</span></span>
<span><span class="co">#     they can only be accessed via the top-level class like below:</span></span>
<span><span class="co">#</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">Connection</span><span class="op">$</span><span class="fu">is</span><span class="op">(</span><span class="va">db</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">'It is a connection!'</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">db</span><span class="op">$</span><span class="fu">is</span><span class="op">(</span><span class="va">db</span><span class="op">)</span> <span class="co"># this will fail!</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check if a connection is valid</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#  NOTE:</span></span>
<span><span class="co">#   - As above, this can only be accessed by the top-level class</span></span>
<span><span class="co">#</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">Connection</span><span class="op">$</span><span class="fu">is.valid</span><span class="op">(</span><span class="va">db</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">'The connection is valid!'</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="member-fields">Member fields<a class="anchor" aria-label="anchor" href="#member-fields"></a>
</h4>
<p>If you need access to the specifics about your
<code><a href="../reference/SAIL-Connection.html">SAILR::Connection</a></code> instance, please see the following class
member fields:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">=</span> <span class="va"><a href="../reference/SAIL-Connection.html">Connection</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span> <span class="co"># if you haven't already connected</span></span>
<span></span>
<span><span class="co"># Determine if the database connection is valid &amp; active</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">connected</span> <span class="co"># -&gt; TRUE / FALSE</span></span>
<span></span>
<span><span class="co"># Get the current connection string</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">connection.string</span> <span class="co"># -&gt; e.g. `UID=username;DSN=PR_SAIL`</span></span>
<span></span>
<span><span class="co"># Get the connected username</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">username</span> <span class="co"># -&gt; e.g. 'my_username'</span></span>
<span></span>
<span><span class="co"># Get the connected database name</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="va">database</span> <span class="co"># -&gt; e.g. 'PR_SAIL'</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="additional-methods">Additional methods<a class="anchor" aria-label="anchor" href="#additional-methods"></a>
</h4>
<p>The following methods are available for those who want to interface
with the <code>ODBC</code> handle or the <code><a href="../reference/SAIL-Profile.html">SAILR::Profile</a></code>
class contained by this instance:</p>
<ol style="list-style-type: decimal">
<li>
<p><code>$get.hnd</code> - retrieves the <code>ODBC</code>
handle:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">=</span> <span class="va"><a href="../reference/SAIL-Connection.html">Connection</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span> <span class="co"># if you haven't already connected</span></span>
<span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">get.hnd</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p><code>$get.profile</code> - retrieves the
<code><a href="../reference/SAIL-Profile.html">SAILR::Profile</a></code> class:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">=</span> <span class="va"><a href="../reference/SAIL-Connection.html">Connection</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span> <span class="co"># if you haven't already connected</span></span>
<span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">get.profile</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</li>
</ol>
</div>
</div>
<div class="section level3">
<h3 id="comparison-of-sailr-and-saildbutils">Comparison of SAILR and SAILDBUtils<a class="anchor" aria-label="anchor" href="#comparison-of-sailr-and-saildbutils"></a>
</h3>
<p>The <code><a href="../reference/SAIL-Connection.html">SAILR::Connection</a></code> class intends to act as an
unofficial, <em>mostly</em> drop-in replacement for the
<code>SAILDBUtils</code> package but there are a few differences that
should be noted. These are highlighted below in the following sections,
and/or can be seen in the many examples described above.</p>
<div class="section level4">
<h4 id="additional-utilities-tooling">Additional utilities &amp; tooling<a class="anchor" aria-label="anchor" href="#additional-utilities-tooling"></a>
</h4>
<p>Please see <code>./DatasetContainer.Rmd</code> and
<code>./Profile.Rmd</code>, both of which are included within the
<code>SAILR</code> namespace and are intended to be used alongside
<code><a href="../reference/SAIL-Connection.html">SAILR::Connection</a></code>.</p>
</div>
<div class="section level4">
<h4 id="dependency-changes">Dependency changes<a class="anchor" aria-label="anchor" href="#dependency-changes"></a>
</h4>
<div class="section level5">
<h5 id="odbc-backend">ODBC backend<a class="anchor" aria-label="anchor" href="#odbc-backend"></a>
</h5>
<p>Unlike the <code>SAILDBUtils</code> package, this package leverages
the <code>ODBC</code> and <code>DBI</code> packages as its ODBC backend,
with both dependencies being authored and maintained by Posit PBC, the
company that created RStudio.</p>
<p>The aforementioned packages were created with the intention of being
an alternative to <code>RODBC</code>, the <code>ODBC</code> package
relied upon by <code>SAILDBUtils</code>, and is typically much faster
than <code>RODBC</code> across several benchmarks. One significant
benefit of this change is that it will likely be maintained for much
longer than <code>RODBC</code> due to its support from both the RStudio
developers &amp; the R development community.</p>
<p>Although <code><a href="../reference/SAIL-Connection.html">SAILR::Connection</a></code> and <code>SAILDBUtils</code>
may share some familiar interfaces, aside from new &amp; additional
features, it should be noted that there are some significant
differences. Unfortunately, some of these differences may require you to
make changes to your codebase.</p>
</div>
<div class="section level5">
<h5 id="string-interpolation">String interpolation<a class="anchor" aria-label="anchor" href="#string-interpolation"></a>
</h5>
<p>String interpolation is the process of evaluating a string containing
placeholders (these are often variables held in the environment) and
yielding a result in which the placeholders are replace/bound by their
corresponding values, <em>e.g.</em> <code>Value: ${5 + 5}</code> becomes
<code>Value: 10</code>.</p>
<p>The <code>SAILDBUtils</code> package relies upon the
<code>GetOptLong</code> to perform string interpolation but
<code>SAILR</code> uses the <code>stringr</code> package; it’s not a
requirement that you use <code>stringr</code> instead of
<code>GetOptLong</code> but it does mean that you will have to call the
<code>library</code> function on <code>GetOptLong</code> yourself to
attach it to your environment.</p>
<p>Here’s a comparison of interpolation in <code>SAILDBUtils</code>
<em>v.s.</em> <code>SAILR</code>:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First, let's load the package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SAILDBUtils</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now let's define some values</span></span>
<span><span class="va">some.value</span> <span class="op">=</span> <span class="st">'Hello, world!'</span></span>
<span><span class="va">some.table.name</span> <span class="op">=</span> <span class="st">'SYSIBM.SYSDUMMY1'</span></span>
<span></span>
<span><span class="co"># Let's connect to the database</span></span>
<span><span class="va">db</span> <span class="op">=</span> <span class="fu">SAILDBUtils</span><span class="fu">::</span><span class="fu">SAILConnect</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Let's run an SQL query using the interpolated statement</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#  NOTE:</span></span>
<span><span class="co">#    - The `qq` function used below to interpolate the string is defined by the</span></span>
<span><span class="co">#      `GetOptLong` package, and can be called from its namespace using</span></span>
<span><span class="co">#      the following: `GetOptLong::qq("Number: @{5}")`</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#    - After interpolation the following query becomes:</span></span>
<span><span class="co">#    ```sql</span></span>
<span><span class="co">#      SELECT</span></span>
<span><span class="co">#          'Hello, world!' AS SOME_TEXT</span></span>
<span><span class="co">#        FROM SYSIBM.SYSDUMMY1;</span></span>
<span><span class="co">#    ```</span></span>
<span><span class="co">#</span></span>
<span><span class="fu">SAILDBUtils</span><span class="fu">::</span><span class="fu">runSQL</span><span class="op">(</span><span class="va">db</span>, <span class="fu">qq</span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  SELECT</span></span>
<span><span class="st">     '@{some.value}' AS SOME_TEXT</span></span>
<span><span class="st">    FROM @{some.table.name};</span></span>
<span><span class="st">"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>In contrast to this, here’s an example using <code>SAILR</code>
instead of <code>SAILDBUtils</code>:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First, let's load the package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SAILR</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now let's define some values</span></span>
<span><span class="va">some.value</span> <span class="op">=</span> <span class="st">'Hello, world!'</span></span>
<span><span class="va">some.table.name</span> <span class="op">=</span> <span class="st">'SYSIBM.SYSDUMMY1'</span></span>
<span></span>
<span><span class="co"># Let's connect to the database</span></span>
<span><span class="va">db</span> <span class="op">=</span> <span class="va"><a href="../reference/SAIL-Connection.html">Connection</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Let's run an SQL query using the interpolated statement</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#  NOTE:</span></span>
<span><span class="co">#   - The `str_interp` function used below is accessible from the `stringr`</span></span>
<span><span class="co">#     namespace, _e.g._ `stringr::str_interp("Number: ${5}")`</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#   - It's IMPORTANT to note that the `stringr` package uses the `${_VALUE_}`</span></span>
<span><span class="co">#     format to define a variable inplace of `GetOptLong`'s method of using the</span></span>
<span><span class="co">#     `@` symbol (_e.g._ `@{_value_}`)</span></span>
<span><span class="co">#</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="fu">str_interp</span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  SELECT</span></span>
<span><span class="st">     '${some.value}' AS SOME_TEXT</span></span>
<span><span class="st">    FROM ${some.table.name};</span></span>
<span><span class="st">"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Do note, <em>however</em>, that you can still use the
<code>GetOptLong</code> package by manually attaching it yourself,
<em>e.g.</em> …</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">GetOptLong</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># In this example we're using the SAILR::Connection and variables defined above!</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="fu">qq</span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  SELECT</span></span>
<span><span class="st">     '@{some.value}' AS SOME_TEXT</span></span>
<span><span class="st">    FROM @{some.table.name};</span></span>
<span><span class="st">"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level4">
<h4 id="the-connection-object">The <code>Connection</code> object<a class="anchor" aria-label="anchor" href="#the-connection-object"></a>
</h4>
<p>The <code>SAILDBUtils</code> package was developed for use within a
mostly functional programming context, and as such, you were required to
pass around the <code>Connection</code> object like so:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the SAILDBUtils package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SAILDBUtils</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Connect to the database</span></span>
<span><span class="va">db</span> <span class="op">=</span> <span class="fu">SAILDBUtils</span><span class="fu">::</span><span class="fu">SAILConnect</span><span class="op">(</span> <span class="co"># or SAILConnect()</span></span>
<span>  username <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">'USERNAME'</span><span class="op">)</span>,</span>
<span>  password <span class="op">=</span> <span class="st">'########'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run some query</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#  NOTE:</span></span>
<span><span class="co">#   - The SQL functions like 'runSQL' live as top-level functions within the</span></span>
<span><span class="co">#     `SAILDBUtils` namespace;</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#   - As such, we have to pass the `db` connection</span></span>
<span><span class="co">#     object to every `SAILDBUtils` function we want to use, e.g. ...</span></span>
<span><span class="co">#</span></span>
<span><span class="va">result</span> <span class="op">=</span> <span class="fu">SAILDBUtils</span><span class="fu">::</span><span class="fu">runSQL</span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  SELECT</span></span>
<span><span class="st">      'Hello, world!' as SOME_TEXT</span></span>
<span><span class="st">    FROM SYSIBM.SYSDUMMY1; </span></span>
<span><span class="st">"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print output:</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#   |   | SOME_TEXT       |</span></span>
<span><span class="co">#   |---|-----------------|</span></span>
<span><span class="co">#   | 1 | 'Hello, world!' |</span></span>
<span><span class="co">#</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
<p>This is where you are most likely to first encounter the most
significant difference; in which, instead of passing around a
<code>Connection</code> object/handle, you are only required to
instantiate a <code><a href="../reference/SAIL-Connection.html">SAILR::Connection</a></code> class once in your
environment and call the methods directly by indexing the
<code><a href="../reference/SAIL-Connection.html">SAILR::Connection</a></code> class, <em>e.g.</em> …</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the SAILR package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SAILR</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Connect to the database</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#  NOTE:</span></span>
<span><span class="co">#   - We're automatically connecting using our stored username and password,</span></span>
<span><span class="co">#     learn more about how this works in the sections above or by visiting</span></span>
<span><span class="co">#     the Profile.Rmd documentation!</span></span>
<span><span class="co">#</span></span>
<span><span class="va">db</span> <span class="op">=</span> <span class="fu">SAILR</span><span class="fu">::</span><span class="va"><a href="../reference/SAIL-Connection.html">Connection</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span> <span class="co"># or Connection$new()</span></span>
<span></span>
<span><span class="co"># Run some query</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#  NOTE:</span></span>
<span><span class="co">#   - Unlike `SAILDBUtils`, we don't have to pass the `db` connection object</span></span>
<span><span class="co">#     around;</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#   - INSTEAD, we just run the query directly by calling the `Connection`'s</span></span>
<span><span class="co">#     method, e.g. ...</span></span>
<span><span class="co">#</span></span>
<span><span class="va">result</span> <span class="op">=</span> <span class="va">db</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">  SELECT</span></span>
<span><span class="st">      'Hello, world!' as SOME_TEXT</span></span>
<span><span class="st">    FROM SYSIBM.SYSDUMMY1;</span></span>
<span><span class="st">"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print output:</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#   |   | SOME_TEXT       |</span></span>
<span><span class="co">#   |---|-----------------|</span></span>
<span><span class="co">#   | 1 | 'Hello, world!' |</span></span>
<span><span class="co">#</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="interface-changes">Interface change(s)<a class="anchor" aria-label="anchor" href="#interface-changes"></a>
</h4>
<div class="section level5">
<h5 id="additional-methods-functions">Additional methods / functions<a class="anchor" aria-label="anchor" href="#additional-methods-functions"></a>
</h5>
<table class="table">
<colgroup>
<col width="21%">
<col width="29%">
<col width="48%">
</colgroup>
<thead><tr class="header">
<th>Addition</th>
<th>Summary</th>
<th>Example</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>$query()</code></td>
<td>Submit a statement to query the database</td>
<td><code>db$query("SELECT * FROM SYSIBM.SYSDUMMY1;")</code></td>
</tr>
<tr class="even">
<td><code>$execute()</code></td>
<td>Submit &amp; execute a statement</td>
<td><code>db$execute("INSERT INTO SCHEMA.TABLE (SOME_COL) VALUES ('HELLO, WORLD!');")</code></td>
</tr>
<tr class="odd">
<td>
<code>$transaction()</code> and
<code>$exit.transaction()</code>
</td>
<td>Submit &amp; execute transactions +/- rollback via exit method</td>
<td>
<code>db$transaction({ ... })</code> where <code>...</code> is your
transaction; rollback via <code>db$exit.transaction()</code>
</td>
</tr>
<tr class="even">
<td><code>$map.from()</code></td>
<td>Map a table’s columns to a subset of columns defined in R</td>
<td><code>db$map.from('SCHEMA.SOME_TABLE', 'SCHEMA.OTHER_TABLE', output.map=list(OLD_COL='NEW_COL))</code></td>
</tr>
<tr class="odd">
<td><code>$grant()</code></td>
<td>Grant user(s) access to a schema and/or its table(s)</td>
<td><code>db$grant('SAILWXXXV', 'SOME_TABLE', list('SOME_USER', 'OHTER_USER'))</code></td>
</tr>
</tbody>
</table>
</div>
<div class="section level5">
<h5 id="name-changes-of-methods-functions">Name changes of methods / functions<a class="anchor" aria-label="anchor" href="#name-changes-of-methods-functions"></a>
</h5>
<p>Alongside additional methods and features, there has been some
changes to the existing function and/or method names:</p>
<table class="table">
<colgroup>
<col width="12%">
<col width="10%">
<col width="43%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th>Old name</th>
<th>New name</th>
<th>Summary</th>
<th>Example</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>SAILConnect()</code></td>
<td><code>$new()</code></td>
<td>Create a new connection</td>
<td><code>db = Connection$new</code></td>
</tr>
<tr class="even">
<td><code>close_connection()</code></td>
<td><code>$finalize()</code></td>
<td>This doesn’t need to be called directly now, will automatically
clean up on removal of <code>db</code>
</td>
<td><code>rm(db)</code></td>
</tr>
<tr class="odd">
<td><code>runSQL()</code></td>
<td><code>$run()</code></td>
<td>Submit and synchronously execute an SQL statement</td>
<td><code>db$run("SELECT * FROM SYSIBM.SYSDUMMY1;")</code></td>
</tr>
<tr class="even">
<td><code>create_table_from_df()</code></td>
<td><code>$save()</code></td>
<td>Create a table, or append to it, from an R
<code>data.frame</code>
</td>
<td><code>db$save('SCHEMA.TABLENAME', data.frame.value)</code></td>
</tr>
<tr class="odd">
<td><code>safe_insert()</code></td>
<td><code>$save()</code></td>
<td>Create a table, or append to it, from an R
<code>data.frame</code>
</td>
<td><code>db$save('SCHEMA.TABLENAME', data.frame.value, can.append=TRUE)</code></td>
</tr>
<tr class="even">
<td><code>create_table_as()</code></td>
<td><code>$create.from()</code></td>
<td>Create a table from an SQL query</td>
<td><code>db$create.from('SCHEMA.TABLENAME', "SELECT * FROM SYSIBM.SYSDUMMY1;")</code></td>
</tr>
<tr class="odd">
<td><code>table_exists()</code></td>
<td><code>$exists()</code></td>
<td>Checks whether a table exists</td>
<td><code>does.exist = db$exists('SCHEMA.TABLENAME')</code></td>
</tr>
<tr class="even">
<td><code>drop_table()</code></td>
<td><code>$drop()</code></td>
<td>Attempts to drop a table</td>
<td><code>db$drop('SCHEMA.TABLENAME')</code></td>
</tr>
<tr class="odd">
<td><code>truncate_table()</code></td>
<td><code>$truncate()</code></td>
<td>Attempts to truncate a table</td>
<td><code>db$truncate('SCHEMA.TABLENAME')</code></td>
</tr>
<tr class="even">
<td><code>is_session()</code></td>
<td><code>$is.temporary()</code></td>
<td>A method to determine whether a table name is a session/temporary
table</td>
<td><code>db$is.temporary('SCHEMA.TABLENAME')</code></td>
</tr>
<tr class="odd">
<td><code>get_connection_details()</code></td>
<td><code>$connection.string</code></td>
<td>A member field describing the connection string</td>
<td><code>details = db$connection.string</code></td>
</tr>
<tr class="even">
<td><code>get_username()</code></td>
<td><code>$username</code></td>
<td>A member field describing the connected user</td>
<td><code>username = db$username</code></td>
</tr>
<tr class="odd">
<td><code>get_DBinstance()</code></td>
<td><code>$database</code></td>
<td>A member field describing the connected database</td>
<td><code>database = db$database</code></td>
</tr>
</tbody>
</table>
</div>
<div class="section level5">
<h5 id="removed-methods-fucntions">Removed methods / fucntions<a class="anchor" aria-label="anchor" href="#removed-methods-fucntions"></a>
</h5>
<p>The following methods / functions have been removed, please find
details of their removal and example replacement code below:</p>
<ol style="list-style-type: decimal">
<li>Window functions via <code>SAILDBUtils::getLogin</code>
<ul>
<li>Removed and replaced by the <a href="./Profile.html">SAILR::Profile</a> class which handles window
logic</li>
<li>If you want to open your own login window then please use the
<code>rstudioapi</code>; you can find out more by entering
<code><a href="https://rstudio.github.io/rstudioapi/reference/askForPassword.html" class="external-link">help('askForPassword', package='rstudioapi')</a></code> or
<code><a href="https://rstudio.github.io/rstudioapi/reference/showQuestion.html" class="external-link">help('showQuestion', package='rstudioapi')</a></code> in the
console<br><br>
</li>
</ul>
</li>
<li>CSV functions via <code>SAILDBUtils::import_from_csv</code>,
<code>SAILDBUtils::export_to_csv</code> and
<code>SAILDBUtils::create_csv_from_table</code>
<ul>
<li>Removed to reduce reliance on multiple dependencies that may not
function in the future</li>
<li>Instead, you are expected to load or save the data yourself into a
<code>data.frame</code> before OR after querying the database,
<em>e.g.</em> …</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SAILR</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Connect to SAIL</span></span>
<span><span class="va">db</span> <span class="op">=</span> <span class="va"><a href="../reference/SAIL-Connection.html">Connection</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read the CSV file into a data.frame</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#  NOTE: `data.table = FALSE` loads it as a `data.frame`</span></span>
<span><span class="co">#</span></span>
<span><span class="va">data</span> <span class="op">=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="st">'./some-path/to/file.csv'</span>, data.table<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save to some table</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">save</span><span class="op">(</span><span class="st">'SESSION.SOME_TABLE'</span>, <span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get the data back out of the table</span></span>
<span><span class="va">data</span> <span class="op">=</span> <span class="va">db</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="st">"SELECT * FROM SESSION.SOME_TABLE;"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save the data</span></span>
<span><span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fwrite.html" class="external-link">fwrite</a></span><span class="op">(</span><span class="st">'./some-path/to/file.csv'</span>, <span class="va">data.frame</span><span class="op">)</span></span></code></pre></div>
<br>
</li>
<li>Phenotype Library interaction via
<code>SAILDBUtils::create_codelist_table_from_concept</code> and
<code>SAILDBUtils::create_codelist_table_from_phenotype</code>
<ul>
<li>Removed to ensure that changes to the Phenotype Library’s API
doesn’t break the DBI package</li>
<li>Instead, you are expected to use the R
<code>ConceptLibraryClient</code> package and load the code list into a
<code>data.frame</code> before creating a table through
<code>db$save()</code><br><br>
</li>
</ul>
</li>
<li>Misc. query wrappers via <code>SAILDBUtils::get_max_value</code>,
<code>SAILDBUtils::get_min_value</code> and
<code>SAILDBUtils::get_row_count</code>
<ul>
<li>The first two functions were removed as they weren’t generic enough
to be useful and the latter was removed as it could <em>only</em> count
table rows</li>
<li>You would be expected to implement these yourself, <em>e.g.</em> in
the case of <code>SAILDBUtils::get_row_count</code> …</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SAILR</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Connect to SAIL</span></span>
<span><span class="va">db</span> <span class="op">=</span> <span class="va"><a href="../reference/SAIL-Connection.html">Connection</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get the row count</span></span>
<span><span class="va">row.count</span> <span class="op">=</span> <span class="va">db</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="st">"SELECT count_big(*) AS ROW_COUNT FROM SYSIBM.SYSDUMMY1;"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">row.count</span><span class="op">$</span><span class="va">ROW_COUNT</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co"># or row.count[1, 'ROW_COUNT'] etc</span></span></code></pre></div>
<br>
</li>
<li>Misc. statement generators via
<code>SAILDBUtils::get_column_info</code> and
<code>SAILDBUtils::get_table_columns</code>
<ul>
<li>These might be added again in the future if required; if these were
particularly helpful to you please contact me!<br>
</li>
</ul>
</li>
</ol>
<p><br></p>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jack Scanlon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
